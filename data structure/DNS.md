# DNS

## DNS란?

- Domain Name System,  IP 네트워크에서 사용하는 시스템
- 일반적인 URL 상에서 영문을 사용해서 진입하나 기본적으로 접속을 위하여 URI 는 IP 주소가 서버를 가르켜야 한다.
- 이를 문자와 주소체계를 상호 확인 및 변환 할 수 있는 서버 시스템

![img.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5c8899bb-f844-4165-bb77-7fd00b4f0a19/img.png)

**1. DNS Query**

DNS 서버에서 Domain Name를 이용하여 IP를 받아온다. 

이때 Domain Name Server 접속하는 유저에 대해서 Round Robin 방식으로 IP 를 할당

**2. IP Communication**

IP 를 받아온 유저는 리퀘스트 메시지 발송을 통하여 정상적으로 네트워크 통신을 실시한다.

## DNS round robin

- DNS 서버 구성 방식 중 하나
- Domain 에 대한 IP 요청 쿼리 시 round-robin 방식으로 IP 를 반환
- 시분할 시스템을 위해 설계된 선점형 스케줄링의 하나로서, 프로세스들 사이에 우선순위를 두지 않고, 순서대로 시간단위(Time Quantum/Slice)로 CPU를 할당하는 방식의 CPU 스케쥴링 알고리즘

(프로세스에 일정시간을 할당하고, 할당된 시간이 지나면 그 프로세스는 잠시 보류한 뒤 다른 프로세스에게 기회를 주고, 또 그 다음 프로세스에게 하는 식으로, 돌아가며 기회를 부여하는 운영방식)

## 장점

DNS 서버에 대한 Round Robin 형식으로 구성할 경우 로드 벨런서가 필요가 없다.

→ why? 자동적으로 시간에 따라 스케쥴링이 변환되서 부하에 대한 걱정이 없다.

## 단점

1. 서버의 수 만큼 공인 IP 주소가 필요하다. → 부하 분산을 위해 서버의 대수를 늘리기 위해서
2. **균등하게 분산되지 않는다.**
3. **서버가 다운되도 확인이 불가능하다.**
    
    즉, DNS 라운드 로빈은 어디까지나 부하분산 을 위한 방법이지 다중화 방법은 아니므로 다른 S/W 와 조합해서 관리할 필요가 있다.
    

## 극복 방법

- **다중화 구성 방식 (Synchronous Time-Division Multiplexing)**
    
    AP 서버에 VIP(Virtual IP)를 부여해서 다중화를 구성한다. 각 AP 서버를 Health Check후 이상이 감지되면 VIP를 정상 AP 서버로 인계하는 방식을 사용한다.
    
    즉 DNS Server Table 에 실시간으로 AP 서버의 상태를 확인할 수 있는 칼럼 및 함수를 추가하여 요청될 경우 서버 상태를 확인하여 우회루트를 제공하거나 에러를 전송하는 방식
    
- **가중치 편성 방식 (Weighted round robin)**
    
    각각의 웹 서버에 가중치를 가미해서 분산 비율을 변경한다. 물론 가중치가 큰 서버일수록 빈번하게 선택되므로 처리능력이 높은 서버는 가중치를 높게 설정하는 것이 좋다.
    
    접속 클라이언트 수가 가장 적은 서버를 선택한다. 로드밸런서에서 실시간으로 connection 수를 관리하거나 각 서버에서 주기적으로 알려주는 것이 필요하다.
    
- **최소 연결 방식 (Least connection) - 로드 밸런서**